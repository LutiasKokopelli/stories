<!-- @SFOLD Header -->
<!DOCTYPE HTML><head><title>FKNO Timeline (Backstory)</title><link rel=icon href=../ast-fkno/ico/chr_eye.png>
<link rel=stylesheet href=../src/css.css>
<link rel=stylesheet href=../src/cs-loremap_main.css>
<link rel=stylesheet href=../src-fkno/cs-loremap.css>
<script src=../src/js.js></script>
<script src=../src-fkno/js-tlback-fkno.js></script>
</head><div class=all><h1 style=font-size:4em>Vanilla FKNO Backstory</h1><div id=tagselect>
<!-- @EFOLD -->



<style>
.tagcategory{padding:17px;height:270px;overflow:auto;text-align:left;border:2px solid rgb(var(--redd));background:rgba(var(--redd),.1)}
.tagcategory h2{font-size:1.7em;opacity:.9}
.tagcategory>p>*,#calendar td>*,#calendar td>span>*,card *{vertical-align:middle}
table{border-spacing:0;margin:1em auto;max-width:95%}
th{padding:12px}tr:has(th){position:sticky;top:0;z-index:50;cursor:pointer}
#calendar *{text-align:center}
#calendar th{background:rgba(0,0,0,.8)}
#calendar th:first-child{border-radius:17px 0 0 17px}#calendar th:last-child{border-radius:0 17px 17px 0}
#calendar td:first-child{border-left:3px solid rgb(var(--white));width:120px}
#calendar td:last-child{border-right:3px solid rgb(var(--white))}
#calendar tr:hover{background:rgba(var(--blue),.42)}
#calendar tr:nth-child(2) td{border-top:3px solid rgb(var(--white))}
#calendar tr td:first-child{padding:.5em}
#calendar tr:nth-child(2) td,#calendar tr:last-child td{background:rgba(var(--white),.9);padding:0}
#calendar tr:not(:last-child,:first-child,:nth-last-child(2),:nth-child(2)) td{border-bottom:1px solid rgb(var(--white))}
#calendar tr:nth-child(2) td:first-child{border-top-left-radius:17px}#calendar tr:nth-child(2) td:last-child{border-top-right-radius:17px}
#calendar tr:nth-last-child(3) td{border-top:1px solid rgb(var(--white))}
#calendar tr:last-child td{border-bottom:3px solid rgb(var(--white))}#calendar tr:last-child td:first-child{border-bottom-left-radius:17px}#calendar tr:last-child td:last-child{border-bottom-right-radius:17px}
#calendar td:first-child{padding:0}
#calendar td:nth-child(2){padding:.2em 0}
#calendar td:nth-child(n+3){font-family:Space Mono;color:rgb(var(--white));font-size:.7em;text-shadow:var(--txtshw)}
a{color:black;font-weight:600;filter:invert(61%)sepia(46%)saturate(3658%)hue-rotate(343deg)brightness(102%)contrast(101%)}
a:hover{filter:invert(92%)sepia(80%)saturate(1818%)hue-rotate(359deg)brightness(103%)contrast(101%)}
input{margin:3px 2px;cursor:pointer;padding:4px 7px;border-radius:1rem;border:2px solid rgb(var(--indigod));line-height:1.7rem}
input:not(.active,.include,.exclude){background-color:rgba(var(--indigod),.8)!important;color:rgb(var(--white))}
.include{background-color:rgba(var(--greend),.8)!important;color:#fff;border-color:rgb(var(--greend))}
.exclude{background-color:rgba(var(--redd),.8)!important;color:#fff;border-color:rgb(var(--redd))}
#tagselect{width:90%;margin:auto;display:grid;border:5px solid rgb(var(--redd))}
h1{color:rgba(var(--white),.9)}
@media only screen and (orientation:landscape){#tagselect{grid-template-columns:1fr 1fr}p{font-size:22px}}
@media only screen and (orientation:portrait){#tagselect{grid-template-columns:1fr}}
card{display:inline-block;border:2px solid rgb(var(--indigod));background:rgba(var(--indigod),.5);border-radius:22px;margin:2px;padding:5px}
card img{display:block;height:64px;margin:auto}img{filter:drop-shadow(0 0 1px rgb(var(--white)))brightness(150%)}
</style>



<!-- @SFOLD Tags -->
<div class=tagcategory><h2>Characters</h2>
<input value=#tektite  style='background-image:url(../ast-fkno/ico/ico_hea_tektite.png) 'type=button onclick=AddTagSelector(this)>
<input value=#spinel   style='background-image:url(../ast-fkno/ico/ico_hea_spinel.png)  'type=button onclick=AddTagSelector(this)>
<input value=#gneiss   style='background-image:url(../ast-fkno/ico/ico_hea_gneiss.png)  'type=button onclick=AddTagSelector(this)>
<input value=#rutile   style='background-image:url(../ast-fkno/ico/ico_hea_rutile.png)  'type=button onclick=AddTagSelector(this)>
<input value=#esker    style='background-image:url(../ast-fkno/ico/ico_hea_esker.png)   'type=button onclick=AddTagSelector(this)>
<input value=#gossan   style='background-image:url(../ast-fkno/ico/ico_hea_gossan.png)  'type=button onclick=AddTagSelector(this)>
<input value=#feldspar style='background-image:url(../ast-fkno/ico/ico_hea_feldspar.png)'type=button onclick=AddTagSelector(this)>
<input value=#slate    style='background-image:url(../ast-fkno/ico/ico_hea_slate.png)   ;background-position:-12px -6px;padding-left:39px'type=button onclick=AddTagSelector(this)>
<input value=#hornfels style='background-image:url(../ast-fkno/ico/ico_hea_hornfels.png)'type=button onclick=AddTagSelector(this)>
<input value=#porphy   style='background-image:url(../ast-fkno/ico/ico_hea_porphy.png)  'type=button onclick=AddTagSelector(this)>
<input value=#chert    style='background-image:url(../ast-fkno/ico/ico_hea_chert.png)   'type=button onclick=AddTagSelector(this)>
<input value=#gabbro   style='background-image:url(../ast-fkno/ico/ico_hea_gabbro.png)  'type=button onclick=AddTagSelector(this)>
<input value=#riebeck  style='background-image:url(../ast-fkno/ico/ico_hea_riebeck.png) 'type=button onclick=AddTagSelector(this)>
<input value=#tuff     style='background-image:url(../ast-fkno/ico/ico_hea_tuff.png)    'type=button onclick=AddTagSelector(this)>
<input value=#marl     style='background-image:url(../ast-fkno/ico/ico_hea_marl.png)    ;background-position:-12px -6px;padding-left:39px'type=button onclick=AddTagSelector(this)>
<input value=#firn     style='background-image:url(../ast-fkno/ico/ico_hea_firn.png)    'type=button onclick=AddTagSelector(this)>
<input value=#hal      style='background-image:url(../ast-fkno/ico/ico_hea_hal.png)     'type=button onclick=AddTagSelector(this)>
<input value=#arkose   style='background-image:url(../ast-fkno/ico/ico_hea_arkose.png)  'type=button onclick=AddTagSelector(this)>
<input value=#moraine  style='background-image:url(../ast-fkno/ico/ico_hea_moraine.png) 'type=button onclick=AddTagSelector(this)>
<input value=#mica     style='background-image:url(../ast-fkno/ico/ico_hea_mica.png)    'type=button onclick=AddTagSelector(this)>
<input value=#galena   style='background-image:url(../ast-fkno/ico/ico_hea_galena.png)  'type=button onclick=AddTagSelector(this)>
<input value=#tephra   style='background-image:url(../ast-fkno/ico/ico_hea_tephra.png)  'type=button onclick=AddTagSelector(this)>
</div><div class=tagcategory><p>
    <!-- <input value='#location accessibility'type=button onclick=AddTagSelector(this)>
    <input value='#warp tower'type=button onclick=AddTagSelector(this)>
    <input value='#warp window'type=button onclick=AddTagSelector(this)>
    <input value='#hearthian clock'type=button onclick=AddTagSelector(this)>
</p><h2>Sub-Locations</h2><p><img src=../img/astr_ashtwin.png>
    <input value='#ash twin project'type=button onclick=AddTagSelector(this)>
</p><p><img src=../img/astr_embertwin.png>
    <input value='#chert'type=button onclick=AddTagSelector(this)> -->
</p></div></div><table id=calendar><tr><th></th><th>Event</th><th width=170px>Date</th><th>Ages</th></tr></table>
<!-- @EFOLD -->






</div><script>table=document.getElementById('calendar');agecol='' //img
const charlist=["Tektite","Spinel","Gneiss","Rutile","Esker","Gossan","Feldspar","Slate","Hornfels","Porphy","Chert","Gabbro","Riebeck","Tuff","Marl","Hal","Firn","Arkose","Moraine","Mica","Galena","Tephra"]
// USE CHARLIST TO ALSO CREATE ALL THE TAG SELECTION BUTTONS?
function date2days(d){return(d[0]*309+d[1]*14+d[2])}
function days2year(a){y=Math.floor(a/309);w=Math.floor(Math.floor((a-y*309)/22));d=Math.floor(a-y*309-w*22);out='';if(y>0){out+=y.toString()+'y '}if(w>0){out+=w.toString()+'w '}if(d>0){out+=d.toString()+'d'}return(out)}
tr=document.createElement('tr');table.appendChild(tr);td=document.createElement('td');td.setAttribute('colspan','9');tr.appendChild(td)
for(const[k,v]of Object.entries(cdta)){
    newtr=document.createElement('tr');newtr.setAttribute('id',k.replace(/^[^a-z]+|[^\w:.-]+/gi, "")+'-@-'+date2days(v["Date"]).toString());table.appendChild(newtr)
    newtd0=document.createElement('td');newtd1=document.createElement('td');newtd2=document.createElement('td');newtd3=document.createElement('td');
    // First image
    if("Image"in v){newtd0.innerHTML=v["Image"]}
    else if(k.endsWith("’s birth")||k.endsWith("’ birth")){newtd0.innerHTML='<img src=../ast-fkno/ico/chr_hea_'+k.replace("’s birth",'').replace("’ birth",'')+'.png>'}
    else{newtd0.innerHTML=""}
    // Lore Map link
    if("LoreID"in v){newtd1.innerHTML='<a href=loremap.html#'+v["LoreID"]+' target=_blank>'+k}else{newtd1.innerHTML=k}
    // Date
    newtd2.innerHTML=v["Date"][0].toString()+'/'+v["Date"][1].toString().padStart(2,"0")+'/'+v["Date"][2].toString().padStart(2,"0")
    ago=date2days(tlday)-date2days(v["Date"]);newtd2.innerHTML+="<br>("+days2year(ago);if(ago>0){newtd2.innerHTML+=" ago"}else{newtd2.innerHTML+="Time Loop Start"}newtd2.innerHTML+=")"
    // Characters
    ages='';for(i=0;i<charlist.length;i++){
        if(charlist[i]+"’s birth"in cdta){akey=charlist[i]+"’s birth"}
        else if(charlist[i]+"’ birth"in cdta){akey=charlist[i]+"’ birth"}
        a=date2days(v["Date"])-date2days(cdta[akey]["Date"])
        if(a>0){
            ages+='<card>'
            if(agecol=='img'){ages+='<img src=../ast-fkno/ico/ico_hea_'+charlist[i]+'.png>'}else{ages+=charlist[i]+': '}
            ages+=days2year(a)+'</card>'
        }
    }newtd3.innerHTML=ages
    // Color, Append, Tags
    if("Color"in v){newtd0.style.background=v['Color'];newtd1.style.background=v['Color'];newtd2.style.background=v['Color'];newtd3.style.background=v['Color']}
    newtr.appendChild(newtd0);newtr.appendChild(newtd1);newtr.appendChild(newtd2);newtr.appendChild(newtd3)
    tags=v["Tags"].split('#');for(i=0;i<tags.length;i++){tags=tags.map(item=>item.trim()).filter(n=>n)}v["Tags"]=tags
}
const tagselect=document.querySelectorAll('div[id="tagselect"] input');for(i=0;i<tagselect.length;i++){tagselect[i].id="btn_"+tagselect[i].value.replace(/^[^a-z]+|[^\w:.-]+/gi, "").slice(1)};var curtinput=[]
function AddTagSelector(tag){
    tag=tag.value.split('#')[1]
    if(curtinput.includes(tag+"0")){curtinput.splice(curtinput.indexOf(tag+"0"),1);document.getElementById("btn_"+tag.replace(/^[^a-z]+|[^\w:.-]+/gi, "")).classList.remove("exclude")}
    else if(curtinput.includes(tag+"1")){curtinput.splice(curtinput.indexOf(tag+"1"),1);curtinput.push(tag+"0");document.getElementById("btn_"+tag.replace(/^[^a-z]+|[^\w:.-]+/gi, "")).classList.remove("include");document.getElementById("btn_"+tag.replace(/^[^a-z]+|[^\w:.-]+/gi, "")).classList.add("exclude")}
    else{curtinput.push(tag+"1");document.getElementById("btn_"+tag.replace(/^[^a-z]+|[^\w:.-]+/gi, "")).classList.add("include")}
    count1=0;for(i=0;i<curtinput.length;i++){if(curtinput[i].slice(-1)==1){count1+=1}}
    for(const[k,v]of Object.entries(cdta)){
        ctr=document.getElementById(k.replace(/^[^a-z]+|[^\w:.-]+/gi, "")+'-@-'+date2days(v["Date"]).toString())
        if(curtinput.length==0){ctr.style.display='';continue}ctr.style.display='';flag=0
        for(i=0;i<curtinput.length;i++){if(v["Tags"].includes(curtinput[i].slice(0,-1))){if(curtinput[i].slice(-1)==1){flag+=1}else{flag=-1;break}}else{if(count1==0){flag=1}}}
        if(v["Tags"].includes("k")||flag>=count1){ctr.style.display=''}else{ctr.style.display='none'}
    }
}
// SET CHRONOLOGICAL ORDER
const elements=[...document.querySelectorAll('tr:has(td:nth-child(3))')]
const collator=new Intl.Collator(undefined,{numeric:true,sensitivity:'base'})
elements.sort((elementA,elementB)=>{
  const [firstElement,secondElement]=true?[elementA,elementB]:[elementB,elementA]
  return collator.compare(firstElement.id.split('-@-')[1],secondElement.id.split('-@-')[1])
}).forEach(element=>table.appendChild(element))
tr=document.createElement('tr');table.appendChild(tr);td=document.createElement('td');td.setAttribute('colspan','9');tr.appendChild(td)
</script>
<link rel=stylesheet href=../../local/cs-datafonts.css>